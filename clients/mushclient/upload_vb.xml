<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Saturday, October 29, 2005, 3:36 AM -->
<!-- MuClient version 3.65 -->

<!-- Plugin "FileBrowse" generated by Plugin Wizard -->

<muclient>
<plugin
   name="upload_vb"
   author="Nveid - RLB"
   id="111111111111234567891234"
   language="VBscript"
   purpose="Browse for files used in Conjunction with Upload_pl.xml"
   date_written="2005-10-29 03:33:58"
   requires="3.65"
   version="1.0"
   >

</plugin>

<!-- Alias -->
<aliases>
	<alias 
		script="DoUploadFileFind" 
		match="#upload" 
		enabled="y"/>
</aliases>
<!--  Script  -->


<script>
<![CDATA[
' Declare the Perl Companion plugin id
Dim Perl_Companion
Perl_Companion = "000000000001234567891234" 
'
'
'
sub OnPluginInstall 

'
'  Delete Upload Directory if it exists.  
'
   if world.GetVariable("Upload.Directory") Then
     world.DeleteVariable("Upload.Directory")
   end if

' Default Set us to send out Adam Dray's Unformat

   world.SetVariable "Upload.Format", "unformat"

end sub

sub DoSetUploadFormat(sName, sLine, wildcards)
    file_format = Trim(wildcards(1))

    Select Case file_format 
        Case "mpp"
	  world.SetVariable "Upload.format", "mpp"
	  world.note "Upload format set to Alan Schwartz's MPP"
	Case "unformat"
	  world.SetVariable "Upload.format", "unformat"
	  world.note "Upload format set to Adam Dray's Unformat 2.0 Beta"
        Case Else
	  world.note "Invalid Upload Format"   
    End Select
end sub

sub DoUploadFileFind(sName, sLine, wildcards)
    Set dialog=CreateObject("UserAccounts.CommonDialog") 

    dialog.Filter = "MUSH Code|*.msh|MUSH Code|*.mush|MPP|*.mpp|MUX Code|*.mux|Text|*.txt|All Files|*.*"

' Grab Start Directory
    start_dir = world.GetVariable("Upload.Directory")

    if start_dir Then
       dialog.InitialDir = start_dir
    End If

    FileWindow = dialog.ShowOpen
        
    if FileWindow = False Then
       world.note "Script Error: Please select a file!"
       exit sub
    else
    '
    ' Now call Perl Companion to send out this file. 
    ' 
       If world.IsPluginInstalled(Perl_Companion) Then
          world.callPlugin Perl_Companion, "Upload", dialog.FileName
       else
          world.note "Upload Perl Companion Not Loaded. Load that first."
	  exit sub
       End If
    End If


    ' Now remember where we're at cause next time we load up, we'll
    ' use this directory
    SlashAt = InStrRev(dialog.FileName, "\")
    world.SetVariable "Upload.Directory", Left(dialog.FileName, SlashAt)
end sub
]]>
</script>


</muclient>
